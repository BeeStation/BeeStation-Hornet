!function(e){function t(t){for(var o,i,c=t[0],s=t[1],l=t[2],u=0,p=[];u<c.length;u++)i=c[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&p.push(r[i][0]),r[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);for(d&&d(t);p.length;)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,c=1;c<n.length;c++){var s=n[c];0!==r[s]&&(o=!1)}o&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={2:0},a=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var d=s;a.push([640,0]),n()}({104:function(e,t,n){"use strict";t.__esModule=!0,t.selectActiveTab=t.selectSettings=void 0;t.selectSettings=function(e){return e.settings};t.selectActiveTab=function(e){return e.settings.view.activeTab}},105:function(e,t,n){"use strict";t.__esModule=!0,t.chatReducer=t.chatMiddleware=t.ChatTabs=t.ChatPanel=t.ChatPageSettings=void 0;var o=n(649);t.ChatPageSettings=o.ChatPageSettings;var r=n(651);t.ChatPanel=r.ChatPanel;var a=n(653);t.ChatTabs=a.ChatTabs;var i=n(654);t.chatMiddleware=i.chatMiddleware;var c=n(655);t.chatReducer=c.chatReducer},106:function(e,t,n){"use strict";t.__esModule=!0,t.isSameMessage=t.serializeMessage=t.createMessage=t.createMainPage=t.createPage=t.canPageAcceptType=void 0;var o=n(650),r=n(107);function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}t.canPageAcceptType=function(e,t){return t.startsWith(r.MESSAGE_TYPE_INTERNAL)||e.acceptedTypes[t]};var c=function(e){return Object.assign({id:(0,o.createUuid)(),name:"New Tab",acceptedTypes:{},unreadCount:0,createdAt:Date.now()},e)};t.createPage=c;t.createMainPage=function(){for(var e,t={},n=a(r.MESSAGE_TYPES);!(e=n()).done;){t[e.value.type]=!0}return c({name:"Main",acceptedTypes:t})};t.createMessage=function(e){return Object.assign({createdAt:Date.now()},e)};t.serializeMessage=function(e){return{type:e.type,text:e.text,html:e.html,times:e.times,createdAt:e.createdAt}};t.isSameMessage=function(e,t){return"string"==typeof e.text&&e.text===t.text||"string"==typeof e.html&&e.html===t.html}},107:function(e,t,n){"use strict";t.__esModule=!0,t.MESSAGE_TYPES=t.MESSAGE_TYPE_DEBUG=t.MESSAGE_TYPE_ATTACKLOG=t.MESSAGE_TYPE_ADMINLOG=t.MESSAGE_TYPE_EVENTCHAT=t.MESSAGE_TYPE_MODCHAT=t.MESSAGE_TYPE_ADMINCHAT=t.MESSAGE_TYPE_COMBAT=t.MESSAGE_TYPE_ADMINPM=t.MESSAGE_TYPE_OOC=t.MESSAGE_TYPE_DEADCHAT=t.MESSAGE_TYPE_WARNING=t.MESSAGE_TYPE_INFO=t.MESSAGE_TYPE_RADIO=t.MESSAGE_TYPE_LOCALCHAT=t.MESSAGE_TYPE_SYSTEM=t.MESSAGE_TYPE_INTERNAL=t.MESSAGE_TYPE_UNKNOWN=t.IMAGE_RETRY_MESSAGE_AGE=t.IMAGE_RETRY_LIMIT=t.IMAGE_RETRY_DELAY=t.COMBINE_MAX_TIME_WINDOW=t.COMBINE_MAX_MESSAGES=t.MESSAGE_PRUNE_INTERVAL=t.MESSAGE_SAVE_INTERVAL=t.MAX_PERSISTED_MESSAGES=t.MAX_VISIBLE_MESSAGES=void 0;t.MAX_VISIBLE_MESSAGES=2500;t.MAX_PERSISTED_MESSAGES=1e3;t.MESSAGE_SAVE_INTERVAL=1e4;t.MESSAGE_PRUNE_INTERVAL=6e4;t.COMBINE_MAX_MESSAGES=5;t.COMBINE_MAX_TIME_WINDOW=5e3;t.IMAGE_RETRY_DELAY=250;t.IMAGE_RETRY_LIMIT=10;t.IMAGE_RETRY_MESSAGE_AGE=6e4;t.MESSAGE_TYPE_UNKNOWN="unknown";t.MESSAGE_TYPE_INTERNAL="internal";t.MESSAGE_TYPE_SYSTEM="system";t.MESSAGE_TYPE_LOCALCHAT="localchat";t.MESSAGE_TYPE_RADIO="radio";t.MESSAGE_TYPE_INFO="info";t.MESSAGE_TYPE_WARNING="warning";t.MESSAGE_TYPE_DEADCHAT="deadchat";t.MESSAGE_TYPE_OOC="ooc";t.MESSAGE_TYPE_ADMINPM="adminpm";t.MESSAGE_TYPE_COMBAT="combat";t.MESSAGE_TYPE_ADMINCHAT="adminchat";t.MESSAGE_TYPE_MODCHAT="modchat";t.MESSAGE_TYPE_EVENTCHAT="eventchat";t.MESSAGE_TYPE_ADMINLOG="adminlog";t.MESSAGE_TYPE_ATTACKLOG="attacklog";t.MESSAGE_TYPE_DEBUG="debug";var o=[{type:"system",name:"System Messages",description:"Messages from your client, always enabled",selector:".boldannounce",important:!0},{type:"localchat",name:"Local",description:"In-character local messages (say, emote, etc)",selector:".say, .emote"},{type:"radio",name:"Radio",description:"All departments of radio messages",selector:".alert, .syndradio, .centradio, .airadio, .entradio, .comradio, .secradio, .engradio, .medradio, .sciradio, .supradio, .srvradio, .expradio, .radio, .deptradio, .newscaster"},{type:"info",name:"Info",description:"Non-urgent messages from the game and items",selector:".notice:not(.pm), .adminnotice, .info, .sinister, .cult"},{type:"warning",name:"Warnings",description:"Urgent messages from the game and items",selector:".warning:not(.pm), .critical, .userdanger, .italics"},{type:"deadchat",name:"Deadchat",description:"All of deadchat",selector:".deadsay"},{type:"ooc",name:"OOC",description:"The bluewall of global OOC messages",selector:".ooc, .adminooc"},{type:"adminpm",name:"Admin PMs",description:"Messages to/from admins (adminhelp)",selector:".pm, .adminhelp"},{type:"combat",name:"Combat Log",description:"Urist McTraitor has stabbed you with a knife!",selector:".danger"},{type:"unknown",name:"Unsorted",description:"Everything we could not sort, always enabled"},{type:"adminchat",name:"Admin Chat",description:"ASAY messages",selector:".admin_channel, .adminsay",admin:!0},{type:"modchat",name:"Mod Chat",description:"MSAY messages",selector:".mod_channel",admin:!0},{type:"adminlog",name:"Admin Log",description:"ADMIN LOG: Urist McAdmin has jumped to coordinates X, Y, Z",selector:".log_message",admin:!0},{type:"attacklog",name:"Attack Log",description:"Urist McTraitor has shot John Doe",admin:!0},{type:"debug",name:"Debug Log",description:"DEBUG: SSPlanets subsystem Recover().",admin:!0}];t.MESSAGE_TYPES=o},145:function(e,t,n){"use strict";t.__esModule=!0,t.selectChatPageById=t.selectCurrentChatPage=t.selectChatPages=t.selectChat=void 0;var o=n(21);t.selectChat=function(e){return e.chat};t.selectChatPages=function(e){return(0,o.map)((function(t){return e.chat.pageById[t]}))(e.chat.pages)};t.selectCurrentChatPage=function(e){return e.chat.pageById[e.chat.currentPageId]};t.selectChatPageById=function(e){return function(t){return t.chat.pageById[e]}}},146:function(e,t,n){"use strict";t.__esModule=!0,t.FONTS=t.FONTS_DISABLED=t.SETTINGS_TABS=void 0;t.SETTINGS_TABS=[{id:"general",name:"General"},{id:"chatPage",name:"Chat Tabs"},{id:"highlightPage",name:"Highlight"},{id:"statPanelpage",name:"Stat Panel"}];t.FONTS_DISABLED="Default";var o=["Default","Verdana","Arial","Arial Black","Comic Sans MS","Impact","Lucida Sans Unicode","Tahoma","Trebuchet MS","Courier New","Lucida Console"];t.FONTS=o},147:function(e,t,n){"use strict";t.__esModule=!0,t.pingReply=t.pingFail=t.pingSuccess=void 0;var o=n(18),r=(0,o.createAction)("ping/success",(function(e){var t=Date.now(),n=.5*(t-e.sentAt);return{payload:{lastId:e.id,roundtrip:n},meta:{now:t}}}));t.pingSuccess=r;var a=(0,o.createAction)("ping/fail");t.pingFail=a;var i=(0,o.createAction)("ping/reply");t.pingReply=i},148:function(e,t,n){"use strict";t.__esModule=!0,t.selectStatPanel=void 0;t.selectStatPanel=function(e){return e.stat}},149:function(e,t,n){"use strict";t.__esModule=!0,t.HoboStatTextAtom=t.HoboStatTextButton=t.HoboStatTextText=t.HoboStatText=t.StatTextVerb=t.StatTextDivider=t.StatTextAtom=t.StatTextButton=t.StatTextText=t.StatText=void 0;var o=n(0),r=n(18),a=n(1),i=n(79),c=n(148),s=n(2),l=n(1),d=n(672);t.StatText=function(e,t){var n=(0,r.useSelector)(t,c.selectStatPanel).statInfomation;if(!n)return(0,o.createComponentVNode)(2,a.Box,{color:"red",children:"Passed stat panel data was null contant coderman (or coderwoman)."});var i=Object.keys(n).filter((function(e){return!!n[e]&&n[e].type===d.STAT_VERB}));return(0,o.createVNode)(1,"div","StatBorder",(0,o.createComponentVNode)(2,a.Section,{children:[n?Object.keys(n).map((function(e){return!!n[e]&&(n[e].type===d.STAT_TEXT&&(0,o.createComponentVNode)(2,u,{title:e,text:n[e].text})||n[e].type===d.STAT_BUTTON&&(0,o.createComponentVNode)(2,p,{title:e,text:n[e].text,action_id:n[e].action,params:n[e].params})||n[e].type===d.STAT_ATOM&&(0,o.createComponentVNode)(2,g,{atom_ref:e,atom_name:n[e].text,atom_icon:n[e].icon})||n[e].type===d.STAT_DIVIDER&&(0,o.createComponentVNode)(2,h)||null)})):"No data",!!i.length&&i.map((function(e){return(0,o.createComponentVNode)(2,m,{title:e,action_id:n[e].action,params:n[e].params},e)}))]}),2)};var u=function(e,t){var n=e.title,r=e.text;return(0,o.createComponentVNode)(2,a.Flex.Item,{mt:1,children:[(0,o.createVNode)(1,"b",null,[n,(0,o.createTextVNode)(":"),(0,o.createTextVNode)(" ")],0),r]})};t.StatTextText=u;var p=function(e,t){var n=e.title,r=e.text,c=e.action_id,l=e.params,d=void 0===l?[]:l;(0,i.useSettings)(t);return(0,o.createComponentVNode)(2,a.Flex.Item,{mt:1,children:(0,o.createComponentVNode)(2,a.Button,{onClick:function(){return(0,s.sendMessage)({type:"stat/pressed",payload:{action_id:c,params:d}})},color:"transparent",children:[(0,o.createVNode)(1,"b",null,[n,(0,o.createTextVNode)(":"),(0,o.createTextVNode)(" ")],0),r]})})};t.StatTextButton=p;var g=function(e,t){var n=e.atom_name,r=e.atom_icon,i=e.atom_ref;return(0,o.createComponentVNode)(2,a.Flex.Item,{mt:1,children:(0,o.createComponentVNode)(2,a.Button,{onClick:function(e){return(0,s.sendMessage)({type:"stat/pressed",payload:{action_id:"atomClick",params:{ref:i}}})},color:"transparent",children:(0,o.createComponentVNode)(2,a.Flex,{children:[(0,o.createComponentVNode)(2,a.Flex.Item,{children:(0,o.createVNode)(1,"img",null,null,1,{src:"data:image/jpeg;base64,"+r,style:{"vertical-align":"middle","horizontal-align":"middle"}})}),(0,o.createComponentVNode)(2,a.Flex.Item,{ml:1,children:n})]})})})};t.StatTextAtom=g;var h=function(e,t){return(0,o.createComponentVNode)(2,l.Divider)};t.StatTextDivider=h;var m=function(e,t){var n=e.title,r=e.action_id,i=e.params,c=void 0===i?[]:i;return(0,o.createComponentVNode)(2,a.Box,{shrink:1,inline:!0,width:"200px",children:(0,o.createComponentVNode)(2,a.Button,{content:n,onClick:function(){return(0,s.sendMessage)({type:"stat/pressed",payload:{action_id:r,params:c}})},color:"transparent",fluid:!0})})};t.StatTextVerb=m;t.HoboStatText=function(e,t){var n=(0,r.useSelector)(t,c.selectStatPanel).statInfomation;if(!n)return(0,o.createComponentVNode)(2,a.Box,{color:"red",children:"Passed stat panel data was null contant coderman (or coderwoman)."});var i=Object.keys(n).filter((function(e){return!!n[e]&&n[e].type===d.STAT_VERB}));return(0,o.createVNode)(1,"div","StatBorder",(0,o.createComponentVNode)(2,a.Section,{children:[n?Object.keys(n).map((function(e){return!!n[e]&&(n[e].type===d.STAT_TEXT&&(0,o.createComponentVNode)(2,f,{title:e,text:n[e].text})||n[e].type===d.STAT_BUTTON&&(0,o.createComponentVNode)(2,v,{title:e,text:n[e].text,action_id:n[e].action,params:n[e].params})||n[e].type===d.STAT_ATOM&&(0,o.createComponentVNode)(2,S,{atom_ref:e,atom_name:n[e].text,atom_icon:n[e].icon})||n[e].type===d.STAT_DIVIDER&&(0,o.createComponentVNode)(2,h)||null)})):"No data",!!i.length&&(0,o.createComponentVNode)(2,a.Box,{wrap:"wrap",align:"left",children:i.map((function(e){return(0,o.createComponentVNode)(2,m,{title:e,action_id:n[e].action,params:n[e].params},e)}))})]}),2)};var f=function(e,t){var n=e.title,r=e.text;return(0,o.createComponentVNode)(2,a.Box,{children:[(0,o.createVNode)(1,"b",null,[n,(0,o.createTextVNode)(":"),(0,o.createTextVNode)(" ")],0),r]})};t.HoboStatTextText=f;var v=function(e,t){var n=e.title,r=e.text,c=e.action_id,l=e.params,d=void 0===l?[]:l;(0,i.useSettings)(t);return(0,o.createComponentVNode)(2,a.Box,{children:(0,o.createComponentVNode)(2,a.Button,{onClick:function(){return(0,s.sendMessage)({type:"stat/pressed",payload:{action_id:c,params:d}})},color:"transparent",children:[(0,o.createVNode)(1,"b",null,[n,(0,o.createTextVNode)(":"),(0,o.createTextVNode)(" ")],0),r]})})};t.HoboStatTextButton=v;var S=function(e,t){var n=e.atom_name,r=e.atom_icon,i=e.atom_ref;return(0,o.createComponentVNode)(2,a.Box,{children:(0,o.createComponentVNode)(2,a.Button,{onClick:function(e){return(0,s.sendMessage)({type:"stat/pressed",payload:{action_id:"atomClick",params:{ref:i}}})},color:"transparent",children:(0,o.createComponentVNode)(2,l.Table,{children:(0,o.createComponentVNode)(2,l.Table.Row,{children:[(0,o.createComponentVNode)(2,l.Table.Cell,{children:(0,o.createVNode)(1,"img",null,null,1,{src:"data:image/jpeg;base64,"+r,style:{"vertical-align":"middle","horizontal-align":"middle"}})}),(0,o.createComponentVNode)(2,l.Table.Cell,{ml:1,children:n})]})})})})};t.HoboStatTextAtom=S},213:function(e,t,n){"use strict";t.__esModule=!0,t.audioReducer=t.NowPlayingWidget=t.audioMiddleware=t.useAudio=void 0;var o=n(644);t.useAudio=o.useAudio;var r=n(645);t.audioMiddleware=r.audioMiddleware;var a=n(647);t.NowPlayingWidget=a.NowPlayingWidget;var i=n(658);t.audioReducer=i.audioReducer},214:function(e,t,n){"use strict";t.__esModule=!0,t.selectAudio=void 0;t.selectAudio=function(e){return e.audio}},215:function(e,t,n){"use strict";t.__esModule=!0,t.useSettings=void 0;var o=n(18),r=n(49),a=n(104);t.useSettings=function(e){var t=(0,o.useSelector)(e,a.selectSettings),n=(0,o.useDispatch)(e);return Object.assign({},t,{visible:t.view.visible,toggle:function(){return n((0,r.toggleSettings)())},update:function(e){return n((0,r.updateSettings)(e))}})}},216:function(e,t,n){"use strict";(function(e){t.__esModule=!0,t.chatRenderer=void 0;var o=n(187),r=n(6),a=n(24),i=n(107),c=n(106),s=n(652);function l(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var u=(0,a.createLogger)("chatRenderer"),p=function(e,t){var n=document.createElement("span");return n.className="Chat__highlight",n.setAttribute("style","background-color:"+t),n.textContent=e,n},g=function(){var e=document.createElement("div");return e.className="ChatMessage",e},h=function(){var e=document.createElement("div");return e.className="Chat__reconnected",e},m=function(e){setTimeout((function(){var t=e.target,n=parseInt(t.getAttribute("data-reload-n"),10)||0;if(n>=i.IMAGE_RETRY_LIMIT)u.error("failed to load an image after "+n+" attempts");else{var o=t.src;t.src=null,t.src=o+"#"+n,t.setAttribute("data-reload-n",n+1)}}),i.IMAGE_RETRY_DELAY)},f=function(e){var t=e.node,n=e.times;if(t&&n){var o=t.querySelector(".Chat__badge"),a=o||document.createElement("div");a.textContent=n,a.className=(0,r.classes)(["Chat__badge","Chat__badge--animate"]),requestAnimationFrame((function(){a.className="Chat__badge"})),o||t.appendChild(a)}},v=function(){function t(){var e=this;this.loaded=!1,this.rootNode=null,this.queue=[],this.messages=[],this.visibleMessages=[],this.page=null,this.events=new o.EventEmitter,this.scrollNode=null,this.scrollTracking=!0,this.handleScroll=function(t){var n=e.scrollNode,o=n.scrollHeight,r=n.scrollTop+n.offsetHeight,a=Math.abs(o-r)<24;a!==e.scrollTracking&&(e.scrollTracking=a,e.events.emit("scrollTrackingChanged",a),u.debug("tracking",e.scrollTracking))},this.ensureScrollTracking=function(){e.scrollTracking&&e.scrollToBottom()},setInterval((function(){return e.pruneMessages()}),i.MESSAGE_PRUNE_INTERVAL)}var n=t.prototype;return n.isReady=function(){return this.loaded&&this.rootNode&&this.page},n.mount=function(t){var n=this;this.rootNode?t.appendChild(this.rootNode):this.rootNode=t,this.scrollNode=function(e){for(var t=document.body,n=e;n&&n!==t;){if(n.scrollWidth<n.offsetWidth)return n;n=n.parentNode}return window}(this.rootNode),this.scrollNode.addEventListener("scroll",this.handleScroll),e((function(){n.scrollToBottom()})),this.tryFlushQueue()},n.onStateLoaded=function(){this.loaded=!0,this.tryFlushQueue()},n.tryFlushQueue=function(){this.isReady()&&this.queue.length>0&&(this.processBatch(this.queue),this.queue=[])},n.assignStyle=function(e){void 0===e&&(e={});for(var t=0,n=Object.keys(e);t<n.length;t++){var o=n[t];this.rootNode.style.setProperty(o,e[o])}},n.setHighlight=function(e,t){if(!e||!t)return this.highlightRegex=null,void(this.highlightColor=null);var n=/^[a-z0-9_\-\s]+$/gi,o=String(e).split(",").map((function(e){return e.trim()})).filter((function(e){return e&&e.length>1&&n.test(e)}));if(0===o.length)return this.highlightRegex=null,void(this.highlightColor=null);this.highlightRegex=new RegExp("("+o.join("|")+")","gi"),this.highlightColor=t},n.setHighContrast=function(e){e!==this.highContrast&&(this.highContrast=e,this.rebuildChat())},n.scrollToBottom=function(){this.scrollNode.scrollTop=this.scrollNode.scrollHeight},n.changePage=function(e){if(!this.isReady())return this.page=e,void this.tryFlushQueue();this.page=e,this.rootNode.textContent="",this.visibleMessages=[];for(var t,n,o=document.createDocumentFragment(),r=l(this.messages);!(n=r()).done;){var a=n.value;(0,c.canPageAcceptType)(e,a.type)&&(t=a.node,o.appendChild(t),this.visibleMessages.push(a))}t&&(this.rootNode.appendChild(o),t.scrollIntoView())},n.getCombinableMessage=function(e){for(var t=Date.now(),n=this.visibleMessages.length,o=n-1,r=Math.max(0,n-i.COMBINE_MAX_MESSAGES),a=o;a>=r;a--){var s=this.visibleMessages[a];if(!s.type.startsWith(i.MESSAGE_TYPE_INTERNAL)&&(0,c.isSameMessage)(s,e)&&t<s.createdAt+i.COMBINE_MAX_TIME_WINDOW)return s}return null},n.processBatch=function(t,n){var o=this;void 0===n&&(n={});var r=n,a=r.prepend,d=r.notifyListeners,v=void 0===d||d,S=Date.now();if(this.isReady()){for(var b,y,C,_,N=document.createDocumentFragment(),T={},x=l(t);!(y=x()).done;){var E=y.value,M=(0,c.createMessage)(E),A=this.getCombinableMessage(M);if(A)A.times=(A.times||1)+1,f(A);else{if(M.node)b=M.node;else if("internal/reconnected"===M.type)b=h();else if(b=g(),M.text?b.textContent=M.text:M.html?this.highContrast?b.innerHTML=(C=M.html,_=void 0,_=new RegExp("(<span[\\w| |\t|=]*['|\"][\\w| ]*)(?:"+["unknown","assistant","atmospherictechnician","bartender","botanist","brigphysician","captain","cargotechnician","chaplain","chemist","chiefengineer","chiefmedicalofficer","clown","cook","curator","deputy","detective","paramedic","geneticist","headofpersonnel","headofsecurity","janitor","lawyer","medicaldoctor","mime","quartermaster","researchdirector","roboticist","scientist","securityofficer","shaftminer","stationengineer","virologist","warden","centcom","prisoner","blob","corgi","fox","rainbow","hierosay","brassmobsay","syndmob","alienmobsay","cultmobsay","slimemobsay"].join("|")+")(['|\"]>)","gi"),C.replace(_,"$1$2")):b.innerHTML=M.html:u.error("Error: message is missing text payload",M),!M.avoidHighlighting&&this.highlightRegex&&(0,s.highlightNode)(b,this.highlightRegex,(function(e){return p(e,o.highlightColor)}))&&(b.className+=" ChatMessage--highlighted"),M.allowLinkify&&(0,s.linkifyNode)(b),S<M.createdAt+i.IMAGE_RETRY_MESSAGE_AGE)for(var V=b.querySelectorAll("img"),I=0;I<V.length;I++)V[I].addEventListener("error",m);if(M.node=b,!M.type){var w=!Byond.IS_LTE_IE8&&i.MESSAGE_TYPES.find((function(e){return e.selector&&b.querySelector(e.selector)}));M.type=(null==w?void 0:w.type)||i.MESSAGE_TYPE_UNKNOWN}f(M),T[M.type]||(T[M.type]=0),T[M.type]+=1,this.messages.push(M),(0,c.canPageAcceptType)(this.page,M.type)&&(N.appendChild(b),this.visibleMessages.push(M))}}if(b){var P=this.rootNode.childNodes[0];a&&P?this.rootNode.insertBefore(N,P):this.rootNode.appendChild(N),this.scrollTracking&&e((function(){return o.scrollToBottom()}))}v&&this.events.emit("batchProcessed",T)}else this.queue=a?[].concat(t,this.queue):[].concat(this.queue,t)},n.pruneMessages=function(){if(this.isReady())if(this.scrollTracking){var e=this.visibleMessages,t=Math.max(0,e.length-i.MAX_VISIBLE_MESSAGES);if(t>0){this.visibleMessages=e.slice(t);for(var n=0;n<t;n++){var o=e[n];this.rootNode.removeChild(o.node),o.node="pruned"}this.messages=this.messages.filter((function(e){return"pruned"!==e.node})),u.log("pruned "+t+" visible messages")}var r=Math.max(0,this.messages.length-i.MAX_PERSISTED_MESSAGES);r>0&&(this.messages=this.messages.slice(r),u.log("pruned "+r+" stored messages"))}else u.debug("pruning delayed")},n.rebuildChat=function(){if(this.isReady()){for(var e,t=Math.max(0,this.messages.length-i.MAX_PERSISTED_MESSAGES),n=this.messages.slice(t),o=l(n);!(e=o()).done;)e.value.node=undefined;this.rootNode.textContent="",this.messages=[],this.visibleMessages=[],this.processBatch(n,{notifyListeners:!1})}},n.saveToDisk=function(){if(!Byond.IS_LTE_IE10){for(var e="",t=document.styleSheets,n=0;n<t.length;n++)for(var o=t[n].cssRules,r=0;r<o.length;r++)e+=o[r].cssText+"\n";e+="body, html { background-color: #141414 }\n";for(var a,i="",c=l(this.messages);!(a=c()).done;){var s=a.value;s.node&&(i+=s.node.outerHTML+"\n")}var d=new Blob(["<!doctype html>\n<html>\n<head>\n<title>SS13 Chat Log</title>\n<style>\n"+e+'</style>\n</head>\n<body>\n<div class="Chat">\n'+i+"</div>\n</body>\n</html>\n"]),u=(new Date).toISOString().substring(0,19).replace(/[-:]/g,"").replace("T","-");window.navigator.msSaveBlob(d,"ss13-chatlog-"+u+".html")}},t}();window.__chatRenderer__||(window.__chatRenderer__=new v);var S=window.__chatRenderer__;t.chatRenderer=S}).call(this,n(101).setImmediate)},217:function(e,t,n){"use strict";t.__esModule=!0,t.setClientTheme=t.THEMES=void 0;t.THEMES=["light","dark"];t.setClientTheme=function(e){if("light"===e)return Byond.winset({"infowindow.background-color":"none","infowindow.text-color":"#000000","info.background-color":"none","info.text-color":"#000000","browseroutput.background-color":"none","browseroutput.text-color":"#000000","outputwindow.background-color":"none","outputwindow.text-color":"#000000","mainwindow.background-color":"none","split.background-color":"none","changelog.background-color":"none","changelog.text-color":"#000000","rules.background-color":"none","rules.text-color":"#000000","wiki.background-color":"none","wiki.text-color":"#000000","forum.background-color":"none","forum.text-color":"#000000","github.background-color":"none","github.text-color":"#000000","report-issue.background-color":"none","report-issue.text-color":"#000000","output.background-color":"none","output.text-color":"#000000","saybutton.background-color":"none","saybutton.text-color":"#000000","oocbutton.background-color":"none","oocbutton.text-color":"#000000","mebutton.background-color":"none","mebutton.text-color":"#000000","asset_cache_browser.background-color":"none","asset_cache_browser.text-color":"#000000","tooltip.background-color":"none","tooltip.text-color":"#000000"});var t="#202020",n="#a4bad6",o="#171717";switch(e){case"dark":t="#202020",n="#a4bad6",o="#171717"}Byond.winset({"infowindow.background-color":t,"infowindow.text-color":n,"info.background-color":t,"info.text-color":n,"browseroutput.background-color":t,"browseroutput.text-color":n,"outputwindow.background-color":t,"outputwindow.text-color":n,"mainwindow.background-color":t,"split.background-color":t,"changelog.background-color":"#494949","changelog.text-color":n,"rules.background-color":"#494949","rules.text-color":n,"wiki.background-color":"#494949","wiki.text-color":n,"forum.background-color":"#494949","forum.text-color":n,"github.background-color":"#3a3a3a","github.text-color":n,"report-issue.background-color":"#492020","report-issue.text-color":n,"output.background-color":o,"output.text-color":n,"saybutton.background-color":t,"saybutton.text-color":n,"oocbutton.background-color":t,"oocbutton.text-color":n,"mebutton.background-color":t,"mebutton.text-color":n,"asset_cache_browser.background-color":t,"asset_cache_browser.text-color":n,"tooltip.background-color":t,"tooltip.text-color":n})}},218:function(e,t,n){"use strict";t.__esModule=!0,t.gameReducer=t.gameMiddleware=t.useGame=void 0;var o=n(659);t.useGame=o.useGame;var r=n(660);t.gameMiddleware=r.gameMiddleware;var a=n(662);t.gameReducer=a.gameReducer},219:function(e,t,n){"use strict";t.__esModule=!0,t.selectGame=void 0;t.selectGame=function(e){return e.game}},220:function(e,t,n){"use strict";t.__esModule=!0,t.connectionRestored=t.connectionLost=t.roundRestarted=void 0;var o=n(18),r=(0,o.createAction)("roundrestart");t.roundRestarted=r;var a=(0,o.createAction)("game/connectionLost");t.connectionLost=a;var i=(0,o.createAction)("game/connectionRestored");t.connectionRestored=i},221:function(e,t,n){"use strict";t.__esModule=!0,t.pingReducer=t.PingIndicator=t.pingMiddleware=void 0;var o=n(664);t.pingMiddleware=o.pingMiddleware;var r=n(665);t.PingIndicator=r.PingIndicator;var a=n(668);t.pingReducer=a.pingReducer},222:function(e,t,n){"use strict";t.__esModule=!0,t.PING_ROUNDTRIP_WORST=t.PING_ROUNDTRIP_BEST=t.PING_QUEUE_SIZE=t.PING_MAX_FAILS=t.PING_TIMEOUT=t.PING_INTERVAL=void 0;t.PING_INTERVAL=2500;t.PING_TIMEOUT=2e3;t.PING_MAX_FAILS=3;t.PING_QUEUE_SIZE=8;t.PING_ROUNDTRIP_BEST=50;t.PING_ROUNDTRIP_WORST=200},223:function(e,t,n){"use strict";t.__esModule=!0,t.HoboStatText=t.StatText=t.HoboStatStatus=t.StatStatus=t.statReducer=t.HoboStatTabs=t.StatTabs=t.statMiddleware=void 0;var o=n(669);t.statMiddleware=o.statMiddleware;var r=n(671);t.StatTabs=r.StatTabs,t.HoboStatTabs=r.HoboStatTabs;var a=n(673);t.statReducer=a.statReducer;var i=n(224);t.StatStatus=i.StatStatus,t.HoboStatStatus=i.HoboStatStatus;var c=n(149);t.StatText=c.StatText,t.HoboStatText=c.HoboStatText},224:function(e,t,n){"use strict";t.__esModule=!0,t.HoboStatStatus=t.StatStatus=void 0;var o=n(0),r=n(18),a=n(1),i=n(148),c=n(149);t.StatStatus=function(e,t){var n=(0,r.useSelector)(t,i.selectStatPanel),s=(0,r.useDispatch)(t);if(n.infomationUpdate)for(var l=0,d=Object.entries(n.infomationUpdate);l<d.length;l++){var u=d[l],p=u[0],g=u[1];p===n.selectedTab&&g}return(0,o.createComponentVNode)(2,a.Flex,{direction:"column",children:[n.dead_popup?(0,o.createComponentVNode)(2,a.Flex.Item,{mt:1,children:(0,o.createComponentVNode)(2,a.Flex,{direction:"column",children:(0,o.createVNode)(1,"div","StatBorder_observer",[(0,o.createComponentVNode)(2,a.Flex.Item,{children:(0,o.createComponentVNode)(2,a.Section,{className:"deadsay",children:[(0,o.createComponentVNode)(2,a.Button,{color:"transparent",icon:"times",onClick:function(){return s({type:"stat/clearDeadPopup"})}}),"You are ",(0,o.createVNode)(1,"b",null,"dead",16),"!"]})}),(0,o.createComponentVNode)(2,a.Flex.Item,{children:(0,o.createComponentVNode)(2,a.Section,{className:"deadsay",children:"Don't worry, you can still get back into the game if your body is revived or through ghost roles."})})],4)})}):null,n.alert_popup?(0,o.createComponentVNode)(2,a.Flex.Item,{mt:1,children:(0,o.createVNode)(1,"div","StatBorder_infomation",(0,o.createComponentVNode)(2,a.Section,{children:(0,o.createComponentVNode)(2,a.Flex,{direction:"column",className:"stat_infomation",children:[(0,o.createComponentVNode)(2,a.Flex.Item,{bold:!0,children:[(0,o.createComponentVNode)(2,a.Button,{color:"transparent",icon:"times",onClick:function(){return s({type:"stat/clearAlertPopup"})}}),(0,o.createComponentVNode)(2,a.Box,{inline:!0,children:n.alert_popup.title})]}),(0,o.createComponentVNode)(2,a.Flex.Item,{mt:2,children:n.alert_popup.text})]})}),2)}):null,n.antagonist_popup?(0,o.createComponentVNode)(2,a.Flex.Item,{mt:1,children:(0,o.createVNode)(1,"div","StatBorder_antagonist",(0,o.createComponentVNode)(2,a.Section,{children:(0,o.createComponentVNode)(2,a.Flex,{direction:"column",className:"stat_antagonist",children:[(0,o.createComponentVNode)(2,a.Flex.Item,{bold:!0,children:[(0,o.createComponentVNode)(2,a.Button,{color:"transparent",icon:"times",onClick:function(){return s({type:"stat/clearAntagPopup"})}}),(0,o.createComponentVNode)(2,a.Box,{inline:!0,children:n.antagonist_popup.title})]}),(0,o.createComponentVNode)(2,a.Flex.Item,{mt:2,children:n.antagonist_popup.text})]})}),2)}):null,(0,o.createComponentVNode)(2,c.StatText)]})};t.HoboStatStatus=function(e,t){var n=(0,r.useSelector)(t,i.selectStatPanel),s=(0,r.useDispatch)(t);if(n.infomationUpdate)for(var l=0,d=Object.entries(n.infomationUpdate);l<d.length;l++){var u=d[l],p=u[0],g=u[1];p===n.selectedTab&&g}return(0,o.createComponentVNode)(2,a.Box,{children:[n.dead_popup?(0,o.createVNode)(1,"div","StatBorder_observer",[(0,o.createComponentVNode)(2,a.Box,{children:(0,o.createComponentVNode)(2,a.Section,{className:"deadsay",children:[(0,o.createComponentVNode)(2,a.Button,{color:"transparent",icon:"times",onClick:function(){return s({type:"stat/clearDeadPopup"})}}),"You are ",(0,o.createVNode)(1,"b",null,"dead",16),"!"]})}),(0,o.createComponentVNode)(2,a.Box,{children:(0,o.createComponentVNode)(2,a.Section,{className:"deadsay",children:"Don't worry, you can still get back into the game if your body is revived or through ghost roles."})})],4):null,n.alert_popup?(0,o.createVNode)(1,"div","StatBorder_infomation",(0,o.createComponentVNode)(2,a.Section,{children:(0,o.createComponentVNode)(2,a.Box,{className:"stat_infomation",children:[(0,o.createComponentVNode)(2,a.Button,{color:"transparent",icon:"times",onClick:function(){return s({type:"stat/clearAlertPopup"})}}),(0,o.createComponentVNode)(2,a.Box,{inline:!0,children:n.alert_popup.title}),(0,o.createComponentVNode)(2,a.Box,{children:n.alert_popup.text})]})}),2):null,n.antagonist_popup?(0,o.createVNode)(1,"div","StatBorder_antagonist",(0,o.createComponentVNode)(2,a.Section,{children:(0,o.createComponentVNode)(2,a.Box,{className:"stat_antagonist",children:[(0,o.createComponentVNode)(2,a.Button,{color:"transparent",icon:"times",onClick:function(){return s({type:"stat/clearAntagPopup"})}}),(0,o.createComponentVNode)(2,a.Box,{inline:!0,bold:!0,children:n.antagonist_popup.title}),(0,o.createComponentVNode)(2,a.Box,{children:n.antagonist_popup.text})]})}),2):null,(0,o.createComponentVNode)(2,c.StatText)]})}},640:function(e,t,n){n(150),e.exports=n(641)},641:function(e,t,n){"use strict";var o=n(0);n(642),n(643);var r,a,i=n(99),c=n(18),s=(n(100),n(51)),l=n(188),d=n(137),u=n(189),p=n(213),g=n(105),h=n(218),m=n(663),f=n(221),v=n(79),S=n(223),b=n(674);function y(e,t,n,o,r,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(o,r)}i.perf.mark("inception",null==(r=window.performance)||null==(a=r.timing)?void 0:a.navigationStart),i.perf.mark("init");var C=(0,u.configureStore)({reducer:(0,c.combineReducers)({audio:p.audioReducer,chat:g.chatReducer,game:h.gameReducer,ping:f.pingReducer,settings:v.settingsReducer,stat:S.statReducer}),middleware:{pre:[g.chatMiddleware,f.pingMiddleware,b.telemetryMiddleware,v.settingsMiddleware,p.audioMiddleware,h.gameMiddleware,S.statMiddleware]}}),_=(0,d.createRenderer)((function(){var e=n(675).Panel;return(0,o.createComponentVNode)(2,u.StoreProvider,{store:C,children:(0,o.createComponentVNode)(2,e)})})),N=function(){var e,t=(e=regeneratorRuntime.mark((function n(e){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===e&&(e="output"),n.next=3,Byond.winget(e);case 3:t=n.sent,Byond.winset("browseroutput",{size:t.size});case 5:case"end":return n.stop()}}),n)})),function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){y(a,o,r,i,c,"next",e)}function c(e){y(a,o,r,i,c,"throw",e)}i(undefined)}))});return function(e){return t.apply(this,arguments)}}();!function T(){if("loading"!==document.readyState){for((0,s.setupGlobalEvents)({ignoreWindowFocus:!0}),(0,m.setupPanelFocusHacks)(),(0,l.captureExternalLinks)(),C.subscribe(_),window.update=function(e){return C.dispatch(Byond.parseJson(e))};;){var e=window.__updateQueue__.shift();if(!e)break;window.update(e)}Byond.winset("output",{"is-visible":!1}),Byond.winset("browseroutput",{"is-visible":!0,"is-disabled":!1,pos:"0x0",size:"0x0"}),N()}else document.addEventListener("DOMContentLoaded",T)}()},642:function(e,t,n){},643:function(e,t,n){},644:function(e,t,n){"use strict";t.__esModule=!0,t.useAudio=void 0;var o=n(18),r=n(214);t.useAudio=function(e){var t=(0,o.useSelector)(e,r.selectAudio),n=(0,o.useDispatch)(e);return Object.assign({},t,{toggle:function(){return n({type:"audio/toggle"})}})}},645:function(e,t,n){"use strict";t.__esModule=!0,t.audioMiddleware=void 0;var o=n(646);t.audioMiddleware=function(e){var t=new o.AudioPlayer;return t.onPlay((function(){e.dispatch({type:"audio/playing"})})),t.onStop((function(){e.dispatch({type:"audio/stopped"})})),function(e){return function(n){var o=n.type,r=n.payload;if("audio/playMusic"===o){var a=r.url,i=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(r,["url"]);return t.play(a,i),e(n)}if("audio/stopMusic"===o)return t.stop(),e(n);if("settings/update"===o||"settings/load"===o){var c=null==r?void 0:r.adminMusicVolume;return"number"==typeof c&&t.setVolume(c),e(n)}return e(n)}}}},646:function(e,t,n){"use strict";function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}t.__esModule=!0,t.AudioPlayer=void 0;var a=(0,n(24).createLogger)("AudioPlayer"),i=function(){function e(){var e=this;Byond.IS_LTE_IE9||(this.node=document.createElement("audio"),this.node.style.setProperty("display","none"),document.body.appendChild(this.node),this.playing=!1,this.volume=1,this.options={},this.onPlaySubscribers=[],this.onStopSubscribers=[],this.node.addEventListener("canplaythrough",(function(){a.log("canplaythrough"),e.playing=!0,e.node.playbackRate=e.options.pitch||1,e.node.currentTime=e.options.start||0,e.node.volume=e.volume,e.node.play();for(var t,n=o(e.onPlaySubscribers);!(t=n()).done;){(0,t.value)()}})),this.node.addEventListener("ended",(function(){a.log("ended"),e.stop()})),this.node.addEventListener("error",(function(t){e.playing&&(a.log("playback error",t.error),e.stop())})),this.playbackInterval=setInterval((function(){e.playing&&(e.options.end>0&&e.node.currentTime>=e.options.end&&e.stop())}),1e3))}var t=e.prototype;return t.destroy=function(){this.node&&(this.node.stop(),document.removeChild(this.node),clearInterval(this.playbackInterval))},t.play=function(e,t){void 0===t&&(t={}),this.node&&(a.log("playing",e,t),this.options=t,this.node.src=e)},t.stop=function(){if(this.node){if(this.playing)for(var e,t=o(this.onStopSubscribers);!(e=t()).done;)(0,e.value)();a.log("stopping"),this.playing=!1,this.node.src=""}},t.setVolume=function(e){this.node&&(this.volume=e,this.node.volume=e)},t.onPlay=function(e){this.node&&this.onPlaySubscribers.push(e)},t.onStop=function(e){this.node&&this.onStopSubscribers.push(e)},e}();t.AudioPlayer=i},647:function(e,t,n){"use strict";t.__esModule=!0,t.NowPlayingWidget=void 0;var o=n(0),r=n(8),a=n(18),i=n(1),c=n(79),s=n(214);t.NowPlayingWidget=function(e,t){var n,l=(0,a.useSelector)(t,s.selectAudio),d=(0,a.useDispatch)(t),u=(0,c.useSettings)(t),p=null==(n=l.meta)?void 0:n.title;return(0,o.createComponentVNode)(2,i.Flex,{align:"center",children:[l.playing&&(0,o.createFragment)([(0,o.createComponentVNode)(2,i.Flex.Item,{shrink:0,mx:.5,color:"label",children:"Now playing:"}),(0,o.createComponentVNode)(2,i.Flex.Item,{mx:.5,grow:1,style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},children:p||"Unknown Track"})],4)||(0,o.createComponentVNode)(2,i.Flex.Item,{grow:1,color:"label",children:"Nothing to play."}),l.playing&&(0,o.createComponentVNode)(2,i.Flex.Item,{mx:.5,fontSize:"0.9em",children:(0,o.createComponentVNode)(2,i.Button,{tooltip:"Stop",icon:"stop",onClick:function(){return d({type:"audio/stopMusic"})}})}),(0,o.createComponentVNode)(2,i.Flex.Item,{mx:.5,fontSize:"0.9em",children:(0,o.createComponentVNode)(2,i.Knob,{minValue:0,maxValue:1,value:u.adminMusicVolume,step:.0025,stepPixelSize:1,format:function(e){return(0,r.toFixed)(100*e)+"%"},onDrag:function(e,t){return u.update({adminMusicVolume:t})}})})]})}},648:function(e,t,n){"use strict";t.__esModule=!0,t.settingsMiddleware=void 0;var o=n(78),r=(n(105),n(217)),a=n(49),i=n(104),c=n(146);t.settingsMiddleware=function(e){var t=!1;return function(n){return function(s){var l,d,u=s.type,p=s.payload;if(t||(t=!0,o.storage.get("panel-settings").then((function(t){e.dispatch((0,a.loadSettings)(t))}))),u===a.updateSettings.type||u===a.loadSettings.type){var g=null==p?void 0:p.theme;g?(0,r.setClientTheme)(g):u===a.loadSettings.type&&(0,a.updateSettings)({theme:"dark"}),n(s);var h=(0,i.selectSettings)(e.getState());return d=h.fontSize,document.documentElement.style.setProperty("font-size",d+"px"),document.body.style.setProperty("font-size",d+"px"),(l=h.fontFamily)===c.FONTS_DISABLED&&(l=null),document.documentElement.style.setProperty("font-family",l),document.body.style.setProperty("font-family",l),void o.storage.set("panel-settings",h)}return n(s)}}}},649:function(e,t,n){"use strict";t.__esModule=!0,t.ChatPageSettings=void 0;var o=n(0),r=n(18),a=n(1),i=n(80),c=n(107),s=n(145);t.ChatPageSettings=function(e,t){var n=(0,r.useSelector)(t,s.selectCurrentChatPage),l=(0,r.useDispatch)(t);return(0,o.createComponentVNode)(2,a.Section,{fill:!0,children:[(0,o.createComponentVNode)(2,a.Flex,{bold:!0,children:"Chat Tab Settings"}),(0,o.createComponentVNode)(2,a.Divider),(0,o.createComponentVNode)(2,a.Flex,{mx:-.5,align:"center",children:[(0,o.createComponentVNode)(2,a.Flex.Item,{mx:.5,grow:1,children:(0,o.createComponentVNode)(2,a.Input,{fluid:!0,value:n.name,onChange:function(e,t){return l((0,i.updateChatPage)({pageId:n.id,name:t}))}})}),(0,o.createComponentVNode)(2,a.Flex.Item,{mx:.5,children:(0,o.createComponentVNode)(2,a.Button,{icon:"times",color:"red",onClick:function(){return l((0,i.removeChatPage)({pageId:n.id}))},children:"Remove"})})]}),(0,o.createComponentVNode)(2,a.Divider),(0,o.createComponentVNode)(2,a.Section,{title:"Messages to display",level:2,children:[c.MESSAGE_TYPES.filter((function(e){return!e.important&&!e.admin})).map((function(e){return(0,o.createComponentVNode)(2,a.Button.Checkbox,{checked:n.acceptedTypes[e.type],onClick:function(){return l((0,i.toggleAcceptedType)({pageId:n.id,type:e.type}))},children:e.name},e.type)})),(0,o.createComponentVNode)(2,a.Collapsible,{mt:1,color:"transparent",title:"Admin stuff",children:c.MESSAGE_TYPES.filter((function(e){return!e.important&&e.admin})).map((function(e){return(0,o.createComponentVNode)(2,a.Button.Checkbox,{checked:n.acceptedTypes[e.type],onClick:function(){return l((0,i.toggleAcceptedType)({pageId:n.id,type:e.type}))},children:e.name},e.type)}))})]})]})}},650:function(e,t,n){"use strict";t.__esModule=!0,t.createUuid=void 0;t.createUuid=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}},651:function(e,t,n){"use strict";t.__esModule=!0,t.ChatPanel=void 0;var o=n(0),r=n(6),a=n(1),i=n(216);var c=function(e){var t,n;function c(){var t;return(t=e.call(this)||this).ref=(0,o.createRef)(),t.state={scrollTracking:!0},t.handleScrollTrackingChange=function(e){return t.setState({scrollTracking:e})},t}n=e,(t=c).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var s=c.prototype;return s.componentDidMount=function(){i.chatRenderer.mount(this.ref.current),i.chatRenderer.events.on("scrollTrackingChanged",this.handleScrollTrackingChange),this.componentDidUpdate()},s.componentWillUnmount=function(){i.chatRenderer.events.off("scrollTrackingChanged",this.handleScrollTrackingChange)},s.componentDidUpdate=function(e){requestAnimationFrame((function(){i.chatRenderer.ensureScrollTracking()})),(!e||(0,r.shallowDiffers)(this.props,e))&&i.chatRenderer.assignStyle({width:"100%","white-space":"pre-wrap","font-size":this.props.fontSize,"line-height":this.props.lineHeight})},s.render=function(){var e=this.state.scrollTracking;return(0,o.createFragment)([(0,o.createVNode)(1,"div","Chat",null,1,null,null,this.ref),!e&&(0,o.createComponentVNode)(2,a.Button,{className:"Chat__scrollButton",icon:"arrow-down",onClick:function(){return i.chatRenderer.scrollToBottom()},children:"Scroll to bottom"})],0)},c}(o.Component);t.ChatPanel=c},652:function(e,t,n){"use strict";t.__esModule=!0,t.linkifyNode=t.highlightNode=t.replaceInTextNode=void 0;var o=function(e,t){return function(n){for(var o,r,a=n.textContent,i=a.length,c=0,s=0;o=e.exec(a);){s+=1,r||(r=document.createDocumentFragment());var l=o[0],d=l.length,u=o.index;c<u&&r.appendChild(document.createTextNode(a.substring(c,u))),c=u+d,r.appendChild(t(l))}return r&&(c<i&&r.appendChild(document.createTextNode(a.substring(c,i))),n.parentNode.replaceChild(r,n)),s}};t.replaceInTextNode=o;var r=function(e){var t=document.createElement("span");return t.setAttribute("style","background-color:#fd4;color:#000"),t.textContent=e,t};t.highlightNode=function i(e,t,n){void 0===n&&(n=r),n||(n=r);for(var a=0,c=e.childNodes,s=0;s<c.length;s++){var l=c[s];3===l.nodeType?a+=o(t,n)(l):a+=i(l,t,n)}return a};t.linkifyNode=function c(e){for(var t=0,n=e.childNodes,o=0;o<n.length;o++){var r=n[o],i=String(r.nodeName).toLowerCase();3===r.nodeType?t+=a(r):"a"!==i&&(t+=c(r))}return t};var a=o(/(?:(?:https?:\/\/)|(?:www\.))(?:[^ ]*?\.[^ ]*?)+[-A-Za-z0-9+&@#/%?=~_|$!:,.;()]+/gi,(function(e){var t=document.createElement("a");return t.href=e,t.textContent=e,t}))},653:function(e,t,n){"use strict";t.__esModule=!0,t.ChatTabs=void 0;var o=n(0),r=n(18),a=n(1),i=n(80),c=n(145),s=n(49),l=function(e){var t=e.value;return(0,o.createComponentVNode)(2,a.Box,{style:{"font-size":"0.7em","border-radius":"0.25em",width:"1.7em","line-height":"1.55em","background-color":"crimson",color:"#fff"},children:Math.min(t,99)})};t.ChatTabs=function(e,t){var n=(0,r.useSelector)(t,c.selectChatPages),d=(0,r.useSelector)(t,c.selectCurrentChatPage),u=(0,r.useDispatch)(t);return(0,o.createComponentVNode)(2,a.Flex,{align:"center",children:[(0,o.createComponentVNode)(2,a.Flex.Item,{children:(0,o.createComponentVNode)(2,a.Tabs,{textAlign:"center",children:n.map((function(e){return(0,o.createComponentVNode)(2,a.Tabs.Tab,{selected:e===d,rightSlot:e.unreadCount>0&&(0,o.createComponentVNode)(2,l,{value:e.unreadCount}),onClick:function(){return u((0,i.changeChatPage)({pageId:e.id}))},children:e.name},e.id)}))})}),(0,o.createComponentVNode)(2,a.Flex.Item,{ml:1,children:(0,o.createComponentVNode)(2,a.Button,{color:"transparent",icon:"plus",onClick:function(){u((0,i.addChatPage)()),u((0,s.openChatSettings)())}})})]})}},654:function(e,t,n){"use strict";t.__esModule=!0,t.chatMiddleware=void 0;var o,r=(o=n(211))&&o.__esModule?o:{"default":o},a=n(78),i=n(49),c=n(104),s=n(80),l=n(107),d=n(106),u=n(216),p=n(145);n(24);function g(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function m(e,t,n,o,r,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(o,r)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){m(a,o,r,i,c,"next",e)}function c(e){m(a,o,r,i,c,"throw",e)}i(undefined)}))}}var v=["a","iframe","link","video"],S=function(){var e=f(regeneratorRuntime.mark((function t(e){var n,o,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=(0,p.selectChat)(e.getState()),o=Math.max(0,u.chatRenderer.messages.length-l.MAX_PERSISTED_MESSAGES),r=u.chatRenderer.messages.slice(o).map((function(e){return(0,d.serializeMessage)(e)})),a.storage.set("chat-state",n),a.storage.set("chat-messages",r);case 5:case"end":return t.stop()}}),t)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=f(regeneratorRuntime.mark((function t(e){var n,o,i,c,l,p,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([a.storage.get("chat-state"),a.storage.get("chat-messages")]);case 2:if(n=t.sent,o=n[0],i=n[1],!(o&&o.version<=4)){t.next=8;break}return e.dispatch((0,s.loadChat)()),t.abrupt("return");case 8:if(i){for(c=g(i);!(l=c()).done;)(p=l.value).html&&(p.html=r["default"].sanitize(p.html,{FORBID_TAGS:v}));h=[].concat(i,[(0,d.createMessage)({type:"internal/reconnected"})]),u.chatRenderer.processBatch(h,{prepend:!0})}e.dispatch((0,s.loadChat)(o));case 10:case"end":return t.stop()}}),t)})));return function(t){return e.apply(this,arguments)}}();t.chatMiddleware=function(e){var t=!1,n=!1;return u.chatRenderer.events.on("batchProcessed",(function(t){n&&e.dispatch((0,s.updateMessageCount)(t))})),u.chatRenderer.events.on("scrollTrackingChanged",(function(t){e.dispatch((0,s.changeScrollTracking)(t))})),setInterval((function(){return S(e)}),l.MESSAGE_SAVE_INTERVAL),function(o){return function(r){var a=r.type,l=r.payload;if(t||(t=!0,b(e)),"chat/message"!==a){if(a===s.loadChat.type){o(r);var d=(0,p.selectCurrentChatPage)(e.getState());return u.chatRenderer.changePage(d),u.chatRenderer.onStateLoaded(),void(n=!0)}if(a!==s.changeChatPage.type&&a!==s.addChatPage.type&&a!==s.removeChatPage.type&&a!==s.toggleAcceptedType.type){if(a===s.rebuildChat.type)return u.chatRenderer.rebuildChat(),o(r);if(a===i.updateSettings.type||a===i.loadSettings.type){o(r);var g=(0,c.selectSettings)(e.getState());return u.chatRenderer.setHighlight(g.highlightText,g.highlightColor),void u.chatRenderer.setHighContrast(g.highContrast)}if("roundrestart"===a)return S(e),o(r);if(a!==s.saveChatToDisk.type)return o(r);u.chatRenderer.saveToDisk()}else{o(r);var h=(0,p.selectCurrentChatPage)(e.getState());u.chatRenderer.changePage(h)}}else{var m=Array.isArray(l)?l:[l];u.chatRenderer.processBatch(m)}}}}},655:function(e,t,n){"use strict";t.__esModule=!0,t.chatReducer=t.initialState=void 0;var o,r=n(80),a=n(106);function i(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var s=(0,a.createMainPage)(),l={version:5,currentPageId:s.id,scrollTracking:!0,pages:[s.id],pageById:(o={},o[s.id]=s,o)};t.initialState=l;t.chatReducer=function(e,t){void 0===e&&(e=l);var n,o=t.type,c=t.payload;if(o===r.loadChat.type){if((null==c?void 0:c.version)!==e.version)return e;for(var d=0,u=Object.keys(c.pageById);d<u.length;d++){var p=u[d];c.pageById[p].unreadCount=0}return Object.assign({},e,c)}if(o===r.changeScrollTracking.type){var g=c,h=Object.assign({},e,{scrollTracking:g});if(g){var m,f=e.currentPageId,v=Object.assign({},e.pageById[f],{unreadCount:0});h.pageById=Object.assign({},e.pageById,((m={})[f]=v,m))}return h}if(o===r.updateMessageCount.type){for(var S,b=c,y=e.pages.map((function(t){return e.pageById[t]})),C=e.pageById[e.currentPageId],_=Object.assign({},e.pageById),N=i(y);!(S=N()).done;){for(var T=S.value,x=0,E=0,M=Object.keys(b);E<M.length;E++){var A=M[E];(0,a.canPageAcceptType)(T,A)&&(T===C&&e.scrollTracking||T!==C&&(0,a.canPageAcceptType)(C,A)||(x+=b[A]))}x>0&&(_[T.id]=Object.assign({},T,{unreadCount:T.unreadCount+x}))}return Object.assign({},e,{pageById:_})}if(o===r.addChatPage.type)return Object.assign({},e,{currentPageId:c.id,pages:[].concat(e.pages,[c.id]),pageById:Object.assign({},e.pageById,(n={},n[c.id]=c,n))});if(o===r.changeChatPage.type){var V,I=c.pageId,w=Object.assign({},e.pageById[I],{unreadCount:0});return Object.assign({},e,{currentPageId:I,pageById:Object.assign({},e.pageById,(V={},V[I]=w,V))})}if(o===r.updateChatPage.type){var P,k=c.pageId,R=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(c,["pageId"]),O=Object.assign({},e.pageById[k],R);return Object.assign({},e,{pageById:Object.assign({},e.pageById,(P={},P[k]=O,P))})}if(o===r.toggleAcceptedType.type){var B,D=c.pageId,G=c.type,F=Object.assign({},e.pageById[D]);return F.acceptedTypes=Object.assign({},F.acceptedTypes),F.acceptedTypes[G]=!F.acceptedTypes[G],Object.assign({},e,{pageById:Object.assign({},e.pageById,(B={},B[D]=F,B))})}if(o===r.removeChatPage.type){var L=c.pageId,j=Object.assign({},e,{pages:[].concat(e.pages),pageById:Object.assign({},e.pageById)});return delete j.pageById[L],j.pages=j.pages.filter((function(e){return e!==L})),0===j.pages.length&&(j.pages.push(s.id),j.pageById[s.id]=s,j.currentPageId=s.id),j.currentPageId&&j.currentPageId!==L||(j.currentPageId=j.pages[0]),j}return e}},656:function(e,t,n){"use strict";t.__esModule=!0,t.settingsReducer=void 0;var o=n(49),r=n(146),a={version:1,fontSize:13,fontFamily:r.FONTS[0],lineHeight:1.2,theme:"light",statSize:40,adminMusicVolume:.5,highlightText:"",highlightColor:"#ffdd44",highContrast:!1,view:{visible:!1,activeTab:r.SETTINGS_TABS[0].id}};t.settingsReducer=function(e,t){void 0===e&&(e=a);var n=t.type,r=t.payload;if(n===o.updateSettings.type)return Object.assign({},e,r);if(n===o.loadSettings.type)return(null==r?void 0:r.version)?(delete r.view,Object.assign({},e,r)):e;if(n===o.toggleSettings.type)return Object.assign({},e,{view:Object.assign({},e.view,{visible:!e.view.visible})});if(n===o.openChatSettings.type)return Object.assign({},e,{view:Object.assign({},e.view,{visible:!0,activeTab:"chatPage"})});if(n===o.changeSettingsTab.type){var i=r.tabId;return Object.assign({},e,{view:Object.assign({},e.view,{activeTab:i})})}return e}},657:function(e,t,n){"use strict";t.__esModule=!0,t.SettingsHighlight=t.SettingsStat=t.SettingsGeneral=t.SettingsPanel=void 0;var o=n(0),r=n(8),a=n(2),i=n(18),c=n(1),s=n(105),l=n(80),d=n(217),u=n(49),p=n(146),g=n(215),h=n(104);t.SettingsPanel=function(e,t){var n=(0,i.useSelector)(t,h.selectActiveTab),r=(0,i.useDispatch)(t);return(0,o.createComponentVNode)(2,c.Flex,{children:[(0,o.createComponentVNode)(2,c.Flex.Item,{mr:1,children:(0,o.createComponentVNode)(2,c.Section,{fitted:!0,fill:!0,minHeight:"8em",children:(0,o.createComponentVNode)(2,c.Tabs,{vertical:!0,children:p.SETTINGS_TABS.map((function(e){return(0,o.createComponentVNode)(2,c.Tabs.Tab,{selected:e.id===n,onClick:function(){return r((0,u.changeSettingsTab)({tabId:e.id}))},children:e.name},e.id)}))})})}),(0,o.createComponentVNode)(2,c.Flex.Item,{grow:1,basis:0,children:["general"===n&&(0,o.createComponentVNode)(2,m),"chatPage"===n&&(0,o.createComponentVNode)(2,s.ChatPageSettings),"highlightPage"===n&&(0,o.createComponentVNode)(2,v),"statPanelpage"===n&&(0,o.createComponentVNode)(2,f)]})]})};var m=function(e,t){var n=(0,i.useSelector)(t,h.selectSettings),s=n.theme,g=n.fontFamily,m=n.highContrast,f=n.fontSize,v=n.lineHeight,S=(0,i.useDispatch)(t),b=(0,a.useLocalState)(t,"freeFont",!1),y=b[0],C=b[1];return(0,o.createComponentVNode)(2,c.Section,{fill:!0,children:[(0,o.createComponentVNode)(2,c.Flex,{bold:!0,children:"General Settings"}),(0,o.createComponentVNode)(2,c.Divider),(0,o.createComponentVNode)(2,c.LabeledList,{children:[(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Theme",children:(0,o.createComponentVNode)(2,c.Dropdown,{selected:s,options:d.THEMES,onSelected:function(e){return S((0,u.updateSettings)({theme:e}))}})}),(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Font style",children:!y&&(0,o.createComponentVNode)(2,c.Dropdown,{selected:g,options:p.FONTS,onSelected:function(e){return S((0,u.updateSettings)({fontFamily:e}))}})||(0,o.createComponentVNode)(2,c.Input,{value:g,onChange:function(e,t){return S((0,u.updateSettings)({fontFamily:t}))}})}),(0,o.createComponentVNode)(2,c.LabeledList.Item,{children:(0,o.createComponentVNode)(2,c.Button,{content:"Custom font",icon:y?"lock-open":"lock",color:y?"good":"bad",ml:1,onClick:function(){C(!y)}})}),(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"High Contrast",children:(0,o.createComponentVNode)(2,c.Button.Checkbox,{checked:!m,onClick:function(){return S((0,u.updateSettings)({highContrast:!m}))},children:"Colored names"})}),(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Font size",children:(0,o.createComponentVNode)(2,c.NumberInput,{width:"4em",step:1,stepPixelSize:10,minValue:8,maxValue:32,value:f,unit:"px",format:function(e){return(0,r.toFixed)(e)},onChange:function(e,t){return S((0,u.updateSettings)({fontSize:t}))}})}),(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Line height",children:(0,o.createComponentVNode)(2,c.NumberInput,{width:"4em",step:.01,stepPixelSize:2,minValue:.8,maxValue:5,value:v,format:function(e){return(0,r.toFixed)(e,2)},onDrag:function(e,t){return S((0,u.updateSettings)({lineHeight:t}))}})})]}),(0,o.createComponentVNode)(2,c.Divider),(0,o.createComponentVNode)(2,c.Button,{icon:"save",onClick:function(){return S((0,l.saveChatToDisk)())},children:"Save chat log"})]})};t.SettingsGeneral=m;var f=function(e,t){var n=(0,g.useSettings)(t),r=(0,i.useDispatch)(t);return(0,o.createComponentVNode)(2,c.Section,{fill:!0,children:[(0,o.createComponentVNode)(2,c.Flex,{bold:!0,children:"Stat Panel Settings"}),(0,o.createComponentVNode)(2,c.Divider),(0,o.createComponentVNode)(2,c.LabeledList,{children:(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Tab Mode",children:(0,o.createComponentVNode)(2,c.Dropdown,{selected:n.statTabMode,options:["Scroll","Multiline"],onSelected:function(e){return r((0,u.updateSettings)({statTabMode:e}))}})})})]})};t.SettingsStat=f;var v=function(e,t){var n=(0,i.useSelector)(t,h.selectSettings),r=n.highlightText,a=n.highlightColor,s=(0,i.useDispatch)(t);return(0,o.createComponentVNode)(2,c.Section,{fill:!0,children:[(0,o.createComponentVNode)(2,c.Box,{children:[(0,o.createComponentVNode)(2,c.Flex,{bold:!0,children:"Highlight Settings"}),(0,o.createComponentVNode)(2,c.Divider),(0,o.createComponentVNode)(2,c.Flex,{mb:1,color:"label",align:"baseline",children:[(0,o.createComponentVNode)(2,c.Flex.Item,{grow:1,children:"Highlight words (comma separated):"}),(0,o.createComponentVNode)(2,c.Flex.Item,{shrink:0,children:[(0,o.createComponentVNode)(2,c.ColorBox,{mr:1,color:a}),(0,o.createComponentVNode)(2,c.Input,{width:"5em",monospace:!0,placeholder:"#ffffff",value:a,onInput:function(e,t){return s((0,u.updateSettings)({highlightColor:t}))}})]})]}),(0,o.createComponentVNode)(2,c.TextArea,{height:"3em",value:r,onChange:function(e,t){return s((0,u.updateSettings)({highlightText:t}))}})]}),(0,o.createComponentVNode)(2,c.Divider),(0,o.createComponentVNode)(2,c.Box,{children:[(0,o.createComponentVNode)(2,c.Button,{icon:"check",onClick:function(){return s((0,l.rebuildChat)())},children:"Apply now"}),(0,o.createComponentVNode)(2,c.Box,{inline:!0,fontSize:"0.9em",ml:1,color:"label",children:"Can freeze the chat for a while."})]})]})};t.SettingsHighlight=v},658:function(e,t,n){"use strict";t.__esModule=!0,t.audioReducer=void 0;var o={visible:!1,playing:!1,track:null};t.audioReducer=function(e,t){void 0===e&&(e=o);var n=t.type,r=t.payload;return"audio/playing"===n?Object.assign({},e,{visible:!0,playing:!0}):"audio/stopped"===n?Object.assign({},e,{visible:!1,playing:!1}):"audio/playMusic"===n?Object.assign({},e,{meta:r}):"audio/stopMusic"===n?Object.assign({},e,{visible:!1,playing:!1,meta:null}):"audio/toggle"===n?Object.assign({},e,{visible:!e.visible}):e}},659:function(e,t,n){"use strict";t.__esModule=!0,t.useGame=void 0;var o=n(18),r=n(219);t.useGame=function(e){return(0,o.useSelector)(e,r.selectGame)}},660:function(e,t,n){"use strict";t.__esModule=!0,t.gameMiddleware=void 0;var o=n(147),r=n(220),a=n(219),i=n(661),c=function(e){return Object.assign({},e,{meta:Object.assign({},e.meta,{now:Date.now()})})};t.gameMiddleware=function(e){var t;return setInterval((function(){var n=e.getState();if(n){var o=(0,a.selectGame)(n),s=t&&Date.now()>=t+i.CONNECTION_LOST_AFTER;!o.connectionLostAt&&s&&e.dispatch(c((0,r.connectionLost)())),o.connectionLostAt&&!s&&e.dispatch(c((0,r.connectionRestored)()))}}),1e3),function(e){return function(n){var a=n.type,i=(n.payload,n.meta);return a===o.pingSuccess.type?(t=i.now,e(n)):a===r.roundRestarted.type?e(c(n)):e(n)}}}},661:function(e,t,n){"use strict";t.__esModule=!0,t.CONNECTION_LOST_AFTER=void 0;t.CONNECTION_LOST_AFTER=15e3},662:function(e,t,n){"use strict";t.__esModule=!0,t.gameReducer=void 0;var o=n(220),r={roundId:null,roundTime:null,roundRestartedAt:null,connectionLostAt:null};t.gameReducer=function(e,t){void 0===e&&(e=r);var n=t.type,a=(t.payload,t.meta);return"roundrestart"===n?Object.assign({},e,{roundRestartedAt:a.now}):n===o.connectionLost.type?Object.assign({},e,{connectionLostAt:a.now}):n===o.connectionRestored.type?Object.assign({},e,{connectionLostAt:null}):e}},663:function(e,t,n){"use strict";(function(e){t.__esModule=!0,t.setupPanelFocusHacks=void 0;var o=n(102),r=n(51),a=n(192),i=function(){return e((function(){return(0,a.focusMap)()}))};t.setupPanelFocusHacks=function(){var e=!1,t=null;window.addEventListener("focusin",(function(t){e=(0,r.canStealFocus)(t.target)})),window.addEventListener("mousedown",(function(e){t=[e.screenX,e.screenY]})),window.addEventListener("mouseup",(function(n){if(t){var r=[n.screenX,n.screenY];(0,o.vecLength)((0,o.vecSubtract)(r,t))>=10&&(e=!0)}e||i()})),r.globalEvents.on("keydown",(function(e){e.isModifierKey()||i()}))}}).call(this,n(101).setImmediate)},664:function(e,t,n){"use strict";t.__esModule=!0,t.pingMiddleware=void 0;var o=n(2),r=n(147),a=n(222);t.pingMiddleware=function(e){var t=!1,n=0,i=[],c=function(){for(var t=0;t<a.PING_QUEUE_SIZE;t++){var c=i[t];c&&Date.now()-c.sentAt>a.PING_TIMEOUT&&(i[t]=null,e.dispatch((0,r.pingFail)()))}var s={index:n,sentAt:Date.now()};i[n]=s,(0,o.sendMessage)({type:"ping",payload:{index:n}}),n=(n+1)%a.PING_QUEUE_SIZE};return function(e){return function(n){var o=n.type,s=n.payload;if(t||(t=!0,setInterval(c,a.PING_INTERVAL),c()),"pingReply"===o){var l=s.index,d=i[l];if(!d)return;return i[l]=null,e((0,r.pingSuccess)(d))}return e(n)}}}},665:function(e,t,n){"use strict";t.__esModule=!0,t.PingIndicator=void 0;var o=n(0),r=n(666),a=n(8),i=n(18),c=n(1),s=n(667);t.PingIndicator=function(e,t){var n=(0,i.useSelector)(t,s.selectPing),l=r.Color.lookup(n.networkQuality,[new r.Color(220,40,40),new r.Color(220,200,40),new r.Color(60,220,40)]),d=n.roundtrip?(0,a.toFixed)(n.roundtrip):"--";return(0,o.createVNode)(1,"div","Ping",[(0,o.createComponentVNode)(2,c.Box,{className:"Ping__indicator",backgroundColor:l}),d],0)}},666:function(e,t,n){"use strict";t.__esModule=!0,t.Color=void 0;var o=function(){function e(e,t,n,o){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===o&&(o=1),this.r=e,this.g=t,this.b=n,this.a=o}return e.prototype.toString=function(){return"rgba("+(0|this.r)+", "+(0|this.g)+", "+(0|this.b)+", "+(0|this.a)+")"},e}();t.Color=o,o.fromHex=function(e){return new o(parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16))},o.lerp=function(e,t,n){return new o((t.r-e.r)*n+e.r,(t.g-e.g)*n+e.g,(t.b-e.b)*n+e.b,(t.a-e.a)*n+e.a)},o.lookup=function(e,t){void 0===t&&(t=[]);var n=t.length;if(n<2)throw new Error("Needs at least two colors!");var r=e*(n-1);if(e<1e-4)return t[0];if(e>=.9999)return t[n-1];var a=r%1,i=0|r;return o.lerp(t[i],t[i+1],a)}},667:function(e,t,n){"use strict";t.__esModule=!0,t.selectPing=void 0;t.selectPing=function(e){return e.ping}},668:function(e,t,n){"use strict";t.__esModule=!0,t.pingReducer=void 0;var o=n(8),r=n(147),a=n(222);t.pingReducer=function(e,t){void 0===e&&(e={});var n=t.type,i=t.payload;if(n===r.pingSuccess.type){var c=i.roundtrip,s=e.roundtripAvg||c,l=Math.round(.4*s+.6*c);return{roundtrip:c,roundtripAvg:l,failCount:0,networkQuality:1-(0,o.scale)(l,a.PING_ROUNDTRIP_BEST,a.PING_ROUNDTRIP_WORST)}}if(n===r.pingFail.type){var d=e.failCount,u=void 0===d?0:d,p=(0,o.clamp01)(e.networkQuality-u/a.PING_MAX_FAILS),g=Object.assign({},e,{failCount:u+1,networkQuality:p});return u>a.PING_MAX_FAILS&&(g.roundtrip=undefined,g.roundtripAvg=undefined),g}return e}},669:function(e,t,n){"use strict";t.__esModule=!0,t.statMiddleware=void 0;var o=n(670),r=n(2);t.statMiddleware=function(e){var t=new o.StatPanel;return function(e){return function(n){var o=n.type,a=n.payload;if("stat/setTab"===o){(0,r.sendMessage)({type:"stat/setTab",payload:{selectedTab:a}});var i=null==a?void 0:a.newTab;return"string"==typeof i&&t.setTab(i),e(n)}return e(n)}}}},670:function(e,t,n){"use strict";t.__esModule=!0,t.StatPanel=void 0;var o=function(){function e(){this.selectedTab="Status"}return e.prototype.setTab=function(e){this.selectedTab=e},e}();t.StatPanel=o},671:function(e,t,n){"use strict";t.__esModule=!0,t.HoboStatTabs=t.StatTabWrap=t.StatTabScroll=t.StatTabs=void 0;var o=n(0),r=n(18),a=n(1),i=n(1),c=n(79),s=n(148),l=n(224),d=n(149);t.StatTabs=function(e,t){var n=(0,r.useSelector)(t,s.selectStatPanel),g=(0,c.useSettings)(t),h=(0,o.createComponentVNode)(2,d.StatText);switch(n.selectedTab){case"Status":h=(0,o.createComponentVNode)(2,l.StatStatus)}return(0,o.createFragment)([(0,o.createComponentVNode)(2,a.Flex.Item,{shrink:0,children:"Scroll"===g.statTabMode?(0,o.createComponentVNode)(2,u):(0,o.createComponentVNode)(2,p)}),(0,o.createComponentVNode)(2,i.ScrollableBox,{overflowY:"scroll",children:(0,o.createComponentVNode)(2,a.Flex.Item,{children:h})})],4)};var u=function(e,t){var n=(0,r.useSelector)(t,s.selectStatPanel),i=(0,r.useDispatch)(t),c=n.statTabs;return(0,o.createComponentVNode)(2,a.Section,{fitted:!0,overflowX:"auto",children:(0,o.createComponentVNode)(2,a.Flex,{align:"center",children:(0,o.createComponentVNode)(2,a.Flex.Item,{children:(0,o.createComponentVNode)(2,a.Tabs,{textAlign:"center",children:c.map((function(e){return(0,o.createComponentVNode)(2,a.Tabs.Tab,{selected:e===n.selectedTab,onClick:function(){return i({type:"stat/setTab",payload:e})},children:e},e)}))})})})})};t.StatTabScroll=u;var p=function(e,t){var n=(0,r.useSelector)(t,s.selectStatPanel),i=(0,r.useDispatch)(t),c=n.statTabs;return(0,o.createComponentVNode)(2,a.Section,{overflowX:"auto",children:c.map((function(e){return(0,o.createComponentVNode)(2,a.Button,{color:"transparent",pr:1.5,pl:1.5,selected:e===n.selectedTab,onClick:function(){return i({type:"stat/setTab",payload:e})},children:e},e)}))})};t.StatTabWrap=p;t.HoboStatTabs=function(e,t){var n=(0,r.useSelector)(t,s.selectStatPanel),a=((0,c.useSettings)(t),(0,o.createComponentVNode)(2,d.HoboStatText));switch(n.selectedTab){case"Status":a=(0,o.createComponentVNode)(2,l.HoboStatStatus)}return(0,o.createComponentVNode)(2,i.Box,{children:[(0,o.createComponentVNode)(2,p),(0,o.createComponentVNode)(2,i.Box,{grow:1,children:a})]})}},672:function(e,t,n){"use strict";t.__esModule=!0,t.STAT_VERB=t.STAT_DIVIDER=t.STAT_ATOM=t.STAT_BUTTON=t.STAT_TEXT=void 0;t.STAT_TEXT=0;t.STAT_BUTTON=1;t.STAT_ATOM=2;t.STAT_DIVIDER=3;t.STAT_VERB=4},673:function(e,t,n){"use strict";t.__esModule=!0,t.statReducer=void 0;var o={selectedTab:"Status",antagonist_popup:null,alert_popup:null,dead_popup:!1,statTabs:[],statInfomation:[],statTabMode:"Scroll"};t.statReducer=function(e,t){void 0===e&&(e=o);var n=t.type,r=t.payload;return"stat/setTab"===n?Object.assign({},e,{selectedTab:r}):"stat/setStatTabs"===n?Object.assign({},e,{statTabs:r}):"stat/setPanelInfomation"===n?Object.assign({},e,{statInfomation:r}):"stat/antagPopup"===n?Object.assign({},e,{antagonist_popup:r}):"stat/clearAntagPopup"===n?Object.assign({},e,{antagonist_popup:null}):"stat/alertPopup"===n?Object.assign({},e,{alert_popup:r}):"stat/clearAlertPopup"===n?Object.assign({},e,{alert_popup:null}):"stat/deadPopup"===n?Object.assign({},e,{antagonist_popup:null,dead_popup:!0}):"stat/clearDeadPopup"===n?Object.assign({},e,{dead_popup:!1}):e}},674:function(e,t,n){"use strict";t.__esModule=!0,t.telemetryMiddleware=void 0;var o=n(2),r=n(78);function a(e,t,n,o,r,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(o,r)}var i=(0,n(24).createLogger)("telemetry");t.telemetryMiddleware=function(e){var t,n;return function(c){return function(s){var l,d=s.type,u=s.payload;if("telemetry/request"!==d)return"backend/update"===d?(c(s),void(l=regeneratorRuntime.mark((function h(){var o,a,c,s;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(a=null==u||null==(o=u.config)?void 0:o.client){l.next=4;break}return i.error("backend/update payload is missing client data!"),l.abrupt("return");case 4:if(t){l.next=13;break}return l.next=7,r.storage.get("telemetry");case 7:if(l.t0=l.sent,l.t0){l.next=10;break}l.t0={};case 10:(t=l.t0).connections||(t.connections=[]),i.debug("retrieved telemetry from storage",t);case 13:c=!1,t.connections.find((function(e){return n=a,(t=e).ckey===n.ckey&&t.address===n.address&&t.computer_id===n.computer_id;var t,n}))||(c=!0,t.connections.unshift(a),t.connections.length>10&&t.connections.pop()),c&&(i.debug("saving telemetry to storage",t),r.storage.set("telemetry",t)),n&&(s=n,n=null,e.dispatch({type:"telemetry/request",payload:s}));case 18:case"end":return l.stop()}}),h)})),function(){var e=this,t=arguments;return new Promise((function(n,o){var r=l.apply(e,t);function i(e){a(r,n,o,i,c,"next",e)}function c(e){a(r,n,o,i,c,"throw",e)}i(undefined)}))})()):c(s);if(!t)return i.debug("deferred"),void(n=u);i.debug("sending");var p=(null==u?void 0:u.limits)||{},g=t.connections.slice(0,p.connections);(0,o.sendMessage)({type:"telemetry",payload:{connections:g}})}}}},675:function(e,t,n){"use strict";t.__esModule=!0,t.Panel=void 0;var o=n(0),r=n(1),a=n(3),i=n(18),c=n(213),s=n(223),l=n(105),d=n(218),u=n(676),p=n(221),g=n(79),h=n(2),m=n(1),f=n(49);t.Panel=function(e,t){if(Byond.IS_LTE_IE10)return(0,o.createComponentVNode)(2,v);var n=(0,c.useAudio)(t),S=(0,g.useSettings)(t),b=(0,d.useGame)(t),y=(0,h.useLocalState)(t,"number",S.statSize),C=y[0],_=(y[1],(0,i.useDispatch)(t));return(0,o.createComponentVNode)(2,a.Pane,{theme:S.theme,children:[(0,o.createComponentVNode)(2,r.Flex,{height:98-C+"%",direction:"column",grow:0,shrink:0,children:(0,o.createComponentVNode)(2,s.StatTabs,{direction:"column"})}),(0,o.createComponentVNode)(2,m.DraggableControl,{value:C,height:"1%",minValue:0,maxValue:100,dragMatrix:[0,-1],step:1,stepPixelSize:9,onDrag:function(e,t){return function(e){_((0,f.updateSettings)({statSize:Math.max(Math.min(e,90),10)}))}(t)},updateRate:5,children:function(e){return(0,o.createComponentVNode)(2,m.Box,{onMouseDown:e.handleDragStart,height:"10px",children:(0,o.createComponentVNode)(2,m.Box,{position:"relative",height:"4px",backgroundColor:"grey",top:"3px",children:[(0,o.createComponentVNode)(2,m.Divider),e.inputElement]})})}}),(0,o.createComponentVNode)(2,r.Flex,{mt:1,direction:"column",height:C-1+"%",children:[(0,o.createComponentVNode)(2,r.Flex.Item,{children:(0,o.createComponentVNode)(2,r.Section,{fitted:!0,children:(0,o.createComponentVNode)(2,r.Flex,{mx:.5,align:"center",children:[(0,o.createComponentVNode)(2,r.Flex.Item,{mx:.5,grow:1,overflowX:"auto",children:(0,o.createComponentVNode)(2,l.ChatTabs)}),(0,o.createComponentVNode)(2,r.Flex.Item,{mx:.5,children:(0,o.createComponentVNode)(2,p.PingIndicator)}),(0,o.createComponentVNode)(2,r.Flex.Item,{mx:.5,children:(0,o.createComponentVNode)(2,r.Button,{color:"grey",selected:n.visible,icon:"music",tooltip:"Music player",tooltipPosition:"bottom-left",onClick:function(){return n.toggle()}})}),(0,o.createComponentVNode)(2,r.Flex.Item,{mx:.5,children:(0,o.createComponentVNode)(2,r.Button,{icon:S.visible?"times":"cog",selected:S.visible,tooltip:S.visible?"Close settings":"Open settings",tooltipPosition:"bottom-left",onClick:function(){return S.toggle()}})})]})})}),n.visible&&(0,o.createComponentVNode)(2,r.Flex.Item,{mt:1,children:(0,o.createComponentVNode)(2,r.Section,{children:(0,o.createComponentVNode)(2,c.NowPlayingWidget)})}),S.visible&&(0,o.createComponentVNode)(2,r.Flex.Item,{mt:1,children:(0,o.createComponentVNode)(2,g.SettingsPanel)}),(0,o.createComponentVNode)(2,r.Flex.Item,{mt:1,grow:1,children:(0,o.createComponentVNode)(2,r.Section,{fill:!0,fitted:!0,position:"relative",children:[(0,o.createComponentVNode)(2,a.Pane.Content,{scrollable:!0,children:(0,o.createComponentVNode)(2,l.ChatPanel,{lineHeight:S.lineHeight})}),(0,o.createComponentVNode)(2,u.Notifications,{children:[b.connectionLostAt&&(0,o.createComponentVNode)(2,u.Notifications.Item,{rightSlot:(0,o.createComponentVNode)(2,r.Button,{color:"white",onClick:function(){return Byond.command(".reconnect")},children:"Reconnect"}),children:"You are either AFK, experiencing lag or the connection has closed."}),b.roundRestartedAt&&(0,o.createComponentVNode)(2,u.Notifications.Item,{children:"The connection has been closed because the server is restarting. Please wait while you automatically reconnect."})]})]})})]})]})};var v=function(e,t){var n=(0,g.useSettings)(t),u=((0,c.useAudio)(t),(0,d.useGame)(t),(0,h.useLocalState)(t,"number",n.statSize)),p=u[0],v=(u[1],(0,i.useDispatch)(t));return(0,o.createComponentVNode)(2,a.Pane,{theme:n.theme,children:[(0,o.createComponentVNode)(2,r.Section,{direction:"column",height:98-p+"%",overflowY:"scroll",children:(0,o.createComponentVNode)(2,s.HoboStatTabs,{height:"100%"})}),(0,o.createComponentVNode)(2,m.DraggableControl,{value:p,height:"1%",minValue:0,maxValue:100,dragMatrix:[0,-1],step:1,stepPixelSize:9,onDrag:function(e,t){return function(e){v((0,f.updateSettings)({statSize:Math.max(Math.min(e,90),10)}))}(t)},updateRate:5,children:function(e){return(0,o.createComponentVNode)(2,m.Box,{onMouseDown:e.handleDragStart,height:"10px",children:(0,o.createComponentVNode)(2,m.Box,{position:"relative",height:"4px",backgroundColor:"grey",top:"3px",children:[(0,o.createComponentVNode)(2,m.Divider),e.inputElement]})})}}),(0,o.createComponentVNode)(2,r.Section,{height:p-1+"%",children:(0,o.createComponentVNode)(2,a.Pane.Content,{scrollable:!0,children:[(0,o.createComponentVNode)(2,r.Button,{style:{position:"fixed",bottom:"3em",right:"2em","z-index":1e3},selected:n.visible,onClick:function(){return n.toggle()},children:"Settings"}),n.visible&&(0,o.createComponentVNode)(2,r.Flex.Item,{mt:1,children:(0,o.createComponentVNode)(2,g.SettingsPanel)})||(0,o.createComponentVNode)(2,l.ChatPanel,{lineHeight:n.lineHeight})]})})]})}},676:function(e,t,n){"use strict";t.__esModule=!0,t.Notifications=void 0;var o=n(0),r=n(1),a=function(e){var t=e.children;return(0,o.createVNode)(1,"div","Notifications",t,0)};t.Notifications=a;a.Item=function(e){var t=e.rightSlot,n=e.children;return(0,o.createComponentVNode)(2,r.Flex,{align:"center",className:"Notification",children:[(0,o.createComponentVNode)(2,r.Flex.Item,{className:"Notification__content",grow:1,children:n}),t&&(0,o.createComponentVNode)(2,r.Flex.Item,{className:"Notification__rightSlot",children:t})]})}},79:function(e,t,n){"use strict";t.__esModule=!0,t.SettingsPanel=t.settingsReducer=t.settingsMiddleware=t.useSettings=void 0;var o=n(215);t.useSettings=o.useSettings;var r=n(648);t.settingsMiddleware=r.settingsMiddleware;var a=n(656);t.settingsReducer=a.settingsReducer;var i=n(657);t.SettingsPanel=i.SettingsPanel},80:function(e,t,n){"use strict";t.__esModule=!0,t.saveChatToDisk=t.changeScrollTracking=t.removeChatPage=t.toggleAcceptedType=t.updateChatPage=t.changeChatPage=t.addChatPage=t.updateMessageCount=t.rebuildChat=t.loadChat=void 0;var o=n(18),r=n(106),a=(0,o.createAction)("chat/load");t.loadChat=a;var i=(0,o.createAction)("chat/rebuild");t.rebuildChat=i;var c=(0,o.createAction)("chat/updateMessageCount");t.updateMessageCount=c;var s=(0,o.createAction)("chat/addPage",(function(){return{payload:(0,r.createPage)()}}));t.addChatPage=s;var l=(0,o.createAction)("chat/changePage");t.changeChatPage=l;var d=(0,o.createAction)("chat/updatePage");t.updateChatPage=d;var u=(0,o.createAction)("chat/toggleAcceptedType");t.toggleAcceptedType=u;var p=(0,o.createAction)("chat/removePage");t.removeChatPage=p;var g=(0,o.createAction)("chat/changeScrollTracking");t.changeScrollTracking=g;var h=(0,o.createAction)("chat/saveToDisk");t.saveChatToDisk=h}});