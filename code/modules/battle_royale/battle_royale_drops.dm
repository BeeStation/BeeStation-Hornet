//===============
// Guns and weapons Stuff
//===============

GLOBAL_LIST_INIT(battle_royale_guns, list(
	/obj/item/kitchen/knife/combat = 15,
	/obj/item/kitchen/knife/poison = 5,
	/obj/item/throwing_star = 10,
	/obj/item/gun/energy/disabler = 10,
	/obj/item/gun/energy/e_gun = 7,
	/obj/item/gun/energy/e_gun/advtaser = 3,
	/obj/item/gun/energy/laser = 6,
	/obj/item/gun/ballistic/revolver = 5,
	/obj/item/gun/ballistic/revolver/detective = 3,
	/obj/item/gun/ballistic/automatic/pistol/deagle/camo = 2,
	/obj/item/gun/ballistic/automatic/gyropistol = 2,
	/obj/item/gun/ballistic/automatic/pistol/suppressed = 6,
	/obj/item/gun/ballistic/shotgun/doublebarrel = 4,
	/obj/item/gun/ballistic/shotgun = 5,
	/obj/item/gun/ballistic/shotgun/automatic/combat = 1,
	/obj/item/gun/ballistic/automatic/ar = 2,
	/obj/item/gun/ballistic/rifle/boltaction = 4,
	/obj/item/pneumatic_cannon/speargun = 1,
	/obj/item/gun/ballistic/automatic/mini_uzi = 5,
	/obj/item/gun/energy/lasercannon = 1,
	/obj/item/gun/energy/kinetic_accelerator/crossbow/large = 4,
	/obj/item/gun/energy/e_gun/nuclear = 1,
	/obj/item/gun/ballistic/automatic/proto = 1,
	/obj/item/gun/ballistic/automatic/c20r = 2,
	/obj/item/gun/ballistic/automatic/l6_saw = 1,
	/obj/item/gun/ballistic/automatic/m90 = 1,
	/obj/item/gun/energy/e_gun/dragnet = 4,
	/obj/item/gun/energy/e_gun/turret = 1,
	/obj/item/gun/energy/pulse/carbine = 1,
	/obj/item/gun/energy/decloner = 5,
	/obj/item/gun/energy/mindflayer = 1,
	/obj/item/gun/energy/kinetic_accelerator = 7,
	/obj/item/gun/energy/plasmacutter/adv = 6,
	/obj/item/gun/energy/wormhole_projector = 1,
	/obj/item/gun/ballistic/automatic/wt550 = 4,
	/obj/item/gun/ballistic/shotgun/bulldog = 2,
	/obj/item/gun/ballistic/revolver/grenadelauncher = 1,
	/obj/item/gun/ballistic/revolver/golden = 1,
	/obj/item/gun/ballistic/automatic/sniper_rifle = 1,
	/obj/item/gun/ballistic/rocketlauncher = 1,
	/obj/item/gun/medbeam = 4,
	/obj/item/gun/energy/laser/scatter = 1,
	/obj/item/gun/energy/gravity_gun = 5,
	/obj/item/gun/energy/ionrifle = 2,
	/obj/item/switchblade = 10,
	/obj/item/club/tailclub = 10,
	/obj/item/nullrod/tribal_knife = 7,
	/obj/item/nullrod/godhand = 4,
	/obj/item/melee/baton/loaded = 16,
	/obj/item/melee/ghost_sword = 4,
	/obj/item/melee/powerfist = 7,
	/obj/item/melee/transforming/energy/sword = 6
))

GLOBAL_LIST_INIT(battle_royale_ammo, list(
	/obj/item/ammo_box/magazine/tommygunm45 = 5,
	/obj/item/ammo_box/magazine/smgm45 = 5,
	/obj/item/ammo_box/magazine/smgm9mm/fire = 2,
	/obj/item/ammo_box/magazine/smgm9mm/ap = 1,
	/obj/item/ammo_box/magazine/smgm9mm = 5,
	/obj/item/ammo_box/magazine/uzim9mm = 5,
	/obj/item/ammo_box/magazine/wt550m9/wtic = 2,
	/obj/item/ammo_box/magazine/wt550m9/wtap = 1,
	/obj/item/ammo_box/magazine/wt550m9 = 5,
	/obj/item/ammo_box/magazine/m75 = 1,
	/obj/item/ammo_box/magazine/mm712x82 = 2,
	/obj/item/ammo_box/magazine/mm712x82/ap = 1,
	/obj/item/ammo_box/magazine/mm712x82/incen = 1,
	/obj/item/ammo_box/magazine/m10mm = 10,
	/obj/item/ammo_box/magazine/m10mm/fire = 6,
	/obj/item/ammo_box/magazine/m10mm/ap = 4,
	/obj/item/ammo_box/magazine/m45 = 8,
	/obj/item/ammo_box/magazine/pistolm9mm = 8,
	/obj/item/ammo_box/magazine/m50 = 4,
	/obj/item/ammo_box/magazine/m10mm/rifle = 8,
	/obj/item/ammo_box/magazine/m556 = 4,
	/obj/item/ammo_box/magazine/m12g = 3,
	/obj/item/ammo_box/magazine/m12g/stun = 1,
	/obj/item/ammo_box/magazine/m12g/slug = 5,
	/obj/item/ammo_box/magazine/m12g/dragon = 1,
	/obj/item/ammo_box/magazine/m12g/breacher = 4,
	/obj/item/ammo_box/magazine/m12g/meteor = 1,
	/obj/item/ammo_box/magazine/sniper_rounds = 3,
	/obj/item/ammo_box/magazine/sniper_rounds/penetrator = 1,
	/obj/item/storage/box/lethalshot = 4
))

//===============
// Healing Stuff
//===============

GLOBAL_LIST_INIT(battle_royale_healing, list(
	/obj/item/storage/firstaid/tactical = 4,
	/obj/item/battle_royale_healing = 14,
	/obj/item/battle_royale_healing/medkit = 1
))

//===============
// Tool Stuff
// Basically just random shit
//===============

GLOBAL_LIST_INIT(battle_royale_tools, list(
	/obj/item/soap = 8,
	/obj/item/syndie_glue = 3,
	/obj/item/card/emag = 6,
	/obj/item/storage/box/emps = 3,
	/obj/item/storage/box/lethalshot = 4,
	/obj/item/storage/box/gorillacubes = 1,
	/obj/item/storage/box/teargas = 6,
	/obj/item/storage/toolbox/syndicate = 8,
	/obj/item/storage/box/syndie_kit/bee_grenades = 1,
	/obj/item/storage/box/syndie_kit/centcom_costume = 1,
	/obj/item/storage/box/syndie_kit/chameleon = 1,
	/obj/item/storage/box/syndie_kit/chemical = 1,
	/obj/item/storage/box/syndie_kit/emp = 1,
	/obj/item/storage/box/syndie_kit/imp_adrenal = 1,
	/obj/item/storage/box/syndie_kit/imp_freedom = 1,
	/obj/item/storage/box/syndie_kit/imp_radio = 1,
	/obj/item/storage/box/syndie_kit/imp_stealth = 1,
	/obj/item/storage/box/syndie_kit/imp_storage = 1,
	/obj/item/storage/box/syndie_kit/imp_uplink = 1,
	/obj/item/storage/box/syndie_kit/origami_bundle = 1,
	/obj/item/storage/box/syndie_kit/throwing_weapons = 1,
	/obj/item/storage/box/syndicate/bundle_A = 1,
	/obj/item/storage/box/syndicate/bundle_B = 1,
	/obj/item/construction/rcd = 5,
))

//===============
// Armor Stuff
//===============

GLOBAL_LIST_INIT(battle_royale_armor, list(
	/obj/item/clothing/glasses/sunglasses/advanced = 7,
	/obj/item/clothing/glasses/thermal/eyepatch = 1,
	/obj/item/clothing/glasses/thermal/syndi = 1,
	/obj/item/clothing/suit/armor/riot = 2,
	/obj/item/clothing/suit/armor/vest = 5,
	/obj/item/clothing/suit/armor/vest/russian_coat = 4,
	/obj/item/clothing/suit/armor/hos/trenchcoat = 3,
	/obj/item/clothing/mask/chameleon = 1,
	/obj/item/clothing/head/centhat = 1,
	/obj/item/clothing/head/crown = 1,
	/obj/item/clothing/head/HoS/syndicate = 3,
	/obj/item/clothing/head/helmet = 4,
	/obj/item/clothing/head/helmet/clockcult = 2,
	/obj/item/clothing/head/helmet/sec = 5,
	/obj/item/clothing/under/syndicate = 4,
	/obj/item/clothing/gloves/combat = 3,
	/obj/item/clothing/suit/space/hardsuit/syndi = 4
))

//===============
// Supply Drop Stuff
//===============

GLOBAL_LIST_INIT(battle_royale_good_loot, list(
		/obj/item/gun/ballistic/bow/clockbolt,
		/obj/item/gun/energy/laser/captain,
		/obj/item/gun/ballistic/revolver/mateba,
		/obj/item/gun/energy/pulse,
		/obj/item/katana,
		/obj/item/twohanded/dualsaber,
		/obj/item/stack/telecrystal/twenty,
		/obj/item/clothing/suit/space/hardsuit/syndi/elite
	))

GLOBAL_LIST_INIT(battle_royale_insane_loot, list(
		/obj/item/gun/ballistic/automatic/l6_saw/unrestricted,
		/obj/item/energy_katana,
		/obj/item/clothing/suit/space/hardsuit/shielded/syndi,
		/obj/item/his_grace,
		/obj/mecha/combat/marauder/mauler/loaded,
		/obj/item/guardiancreator/tech,
		/obj/item/twohanded/mjollnir,
		/obj/item/pneumatic_cannon/pie/selfcharge,
		/obj/item/uplink/nuclear
	))

//==================================
// EVENTS / DROPS
//==================================

/datum/battle_royale_controller/proc/generate_basic_loot(amount=1)
	for(var/i in 1 to amount)
		var/list/items = list()
		switch(rand(1, 5))
			if(1)
				items += pickweight(GLOB.battle_royale_tools)
				items += pickweight(GLOB.battle_royale_healing)
				items += pickweight(GLOB.battle_royale_guns)
			if(2)
				items += pickweight(GLOB.battle_royale_ammo)
				items += pickweight(GLOB.battle_royale_tools)
				items += pickweight(GLOB.battle_royale_tools)
			if(3)
				items += pickweight(GLOB.battle_royale_healing)
				items += pickweight(GLOB.battle_royale_ammo)
				items += pickweight(GLOB.battle_royale_guns)
			if(4)
				items += pickweight(GLOB.battle_royale_ammo)
				items += pickweight(GLOB.battle_royale_ammo)
				items += pickweight(GLOB.battle_royale_ammo)
			if(5)
				items += pickweight(GLOB.battle_royale_guns)
		CHECK_TICK
		send_item(items)

/datum/battle_royale_controller/proc/generate_good_drop()
	var/list/good_drops = list()
	for(var/i in 1 to rand(1,3))
		good_drops += pick(GLOB.battle_royale_good_loot)
	send_item(good_drops, announce = "Incomming extended supply materials.", force_time = 600)

/datum/battle_royale_controller/proc/generate_endgame_drop()
	var/obj/item = pick(GLOB.battle_royale_insane_loot)
	send_item(item, announce = "We found a weird looking package in the back of our warehouse. We have no idea what is in it, but it is marked as incredibily dangerous and could be a superweapon.", force_time = 9000)

/datum/battle_royale_controller/proc/send_item(item_path, style = STYLE_BOX, announce=FALSE, force_time = 0)
	if(!item_path)
		return
	var/turf/target = pick(GLOB.br_lootdrop)
	var/obj/structure/closet/supplypod/battleroyale/pod = new()
	if(islist(item_path))
		for(var/thing in item_path)
			new thing(pod)
	else
		new item_path(pod)
	if(force_time)
		pod.fallDuration = force_time
	new /obj/effect/DPtarget(target, pod)
	if(announce)
		priority_announce("[announce] \nExpected Drop Location: [get_area(target)]\n ETA: [force_time/10] Seconds.", "High Command Supply Control")
